(this.webpackJsonp=this.webpackJsonp||[]).push([["chunk-5507"],{Syo2:function(e,t,s){e.exports={mainColor:"#4090CF",navHeight:"60px",navBg:"#4090CF",navText:"#4090CF",navActiveText:"#4090CF",mainFontColor:"#191F25",footerHeight:"120px",footerBg:"#727171"}},TvGh:function(e,t,s){},hx2X:function(e,t,s){"use strict";var i=s("TvGh");s.n(i).a},lpxY:function(e,t,s){"use strict";s.r(t);var i=s("p46w"),o=s.n(i),a=s("Q2AE"),n="token";s("J66h").Base64;function l(){return o.a.get(n)}var r={name:"FileUpload",props:{typeCode:{type:String,default:"img"},listType:{type:String,default:"picture"},tip:{type:String,default:""}},data:function(){return{actionApi:"/api//tools/file/upload",headers:{Authorization:"Bearer "+l()},showControl:!1,uploadSuccess:!1}},computed:{},watch:{},mounted:function(){},methods:{handleSuccess:function(e,t){200===e.code?(this.uploadSuccess=!0,this.$emit("success",e.data.resId,e.data.resUrl)):(this.uploadSuccess=!1,this.$emit("error"),this.$message.error("文件上传失败: "+e.msg))},handleError:function(e){this.uploadSuccess=!1,this.$emit("error"),this.$message.error("文件上传失败: "+e)},handleRemoveFile:function(){this.showControl=!1,this.uploadSuccess=!1,this.$emit("remove")},handleChangeFile:function(e){"ready"===e.status&&(this.uploadSuccess=!1)},beforeUpload:function(e){if((console.log(this.$attrs),this.$attrs["size-limit"])&&!(e.size/1024/1024<this.$attrs["size-limit"])){var t=this.$attrs["size-limit"]+"MB";return this.$attrs["size-limit"]<1&&(t=1024*this.$attrs["size-limit"]+"KB"),this.$message.error("上传文件不能超过"+t),!1}return!0},showImageControl:function(){var e=this.$refs.uploadRef.$el.getElementsByTagName("img")[0];e&&e.src&&(this.showControl=!0)},hideImageControl:function(){this.showControl=!1}}},c=(s("hx2X"),s("KHd+")),d=Object(c.a)(r,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-upload",e._b({ref:"uploadRef",staticClass:"upload-wrapper",attrs:{headers:e.headers,data:{typeCode:e.typeCode},action:e.actionApi,"before-upload":e.beforeUpload,"on-success":e.handleSuccess,"on-error":e.handleError,"on-change":e.handleChangeFile,"on-remove":e.handleRemoveFile}},"el-upload",e.$attrs,!1),[e._t("inner",[s("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{size:"small",type:"primary"}},[e._v("点击上传")])]),e._v(" "),"text"!==e.listType&&e.uploadSuccess?s("div",{staticClass:"control-wrapper"},[s("label",{staticClass:"success-label"},[s("i",{staticClass:"el-icon-check"})])]):e._e(),e._v(" "),e._t("control",["text"!==e.listType?s("div",{staticClass:"control-wrapper",on:{mouseover:e.showImageControl,mouseout:e.hideImageControl}},[s("div",{staticClass:"mask",style:{visibility:e.showControl?"visible":"hidden"}},[s("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.handleRemoveFile(t)}}})])]):e._e()]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.tip))])],2)},[],!1,null,null,null);d.options.__file="FileUpload.vue";var u=d.exports,p=s("4d7F"),h=s.n(p),m=s("vDqi"),v=s.n(m),f=s("XJYT"),y=v.a.create({baseURL:"/api/",timeout:1e5});y.interceptors.request.use(function(e){return a.a.getters.token&&(e.headers.Authorization="Bearer "+l()),e},function(e){console.log(e),h.a.reject(e)}),y.interceptors.response.use(function(e){var t=e.data;return 200!==t.code?(402===t.code||403===t.code||405===t.code?f.MessageBox.confirm(t.msg,"确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then(function(){a.a.dispatch("FedLogOut").then(function(){location.reload()})}):Object(f.Message)({message:t.msg,type:"error",duration:5e3}),h.a.reject(t.msg)):e.data},function(e){return Object(f.Message)({message:e.message,type:"error",duration:5e3}),h.a.reject(e)});var g=y;var C={name:"Index",components:{FileUpload:u},data:function(){return{selType:"",xmlReady:!1,midiReady:!1,loading:!1}},computed:{isDownloadDisable:function(){return""===this.selType||("1"===this.selType&&!this.xmlReady||(!("2"!==this.selType||this.xmlReady&&this.midiReady)||!("3"!==this.selType||this.xmlReady&&this.midiReady)))},isMidiTipShow:function(){return""!==this.selType&&("1"!==this.selType&&(("2"!==this.selType||!this.midiReady)&&("3"!==this.selType||!this.midiReady)))}},methods:{download:function(){this.loading=!0,function(e){return g({url:"/tools/file/download",method:"post",data:e})}({type:this.selType}).then(function(e){var t=e.data.resUrl,s=document.createElement("a");s.href=t,s.click()})},xmlSuccess:function(e){this.xmlReady=!0},xmlError:function(){this.xmlReady=!1},midiSuccess:function(e){this.midiReady=!0},midiError:function(){this.midiReady=!1}}},w=(s("qGKE"),Object(c.a)(C,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"layout"},[s("div",{staticClass:"content"},[s("div",[e._v("请选择乐器：")]),e._v(" "),s("el-select",{staticClass:"content-content",attrs:{placeholder:"请选择"},model:{value:e.selType,callback:function(t){e.selType=t},expression:"selType"}},[s("el-option",{attrs:{label:"钢琴",value:"1"}}),e._v(" "),s("el-option",{attrs:{label:"小提琴",value:"2"}}),e._v(" "),s("el-option",{attrs:{label:"架子鼓",value:"3"}})],1),e._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:""===e.selType,expression:"selType===''"}],staticClass:"el-icon-warning tip"})],1),e._v(" "),s("div",{staticClass:"content"},[s("div",[e._v("请上传xml文件：")]),e._v(" "),s("file-upload",{staticClass:"content-content",on:{success:e.xmlSuccess,error:e.xmlError}}),e._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:!e.xmlReady,expression:"!xmlReady"}],staticClass:"el-icon-warning tip"})],1),e._v(" "),s("div",{staticClass:"content"},[s("div",[e._v("请上传mid文件：")]),e._v(" "),s("file-upload",{staticClass:"content-content",on:{success:e.midiSuccess,error:e.midiError}}),e._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:e.isMidiTipShow,expression:"isMidiTipShow"}],staticClass:"el-icon-warning tip"})],1),e._v(" "),s("el-button",{staticClass:"content",attrs:{disabled:e.isDownloadDisable,icon:"el-icon-download"},on:{click:e.download,load:e.loading}},[e._v("下载")])],1)])},[],!1,null,null,null));w.options.__file="Index.vue";t.default=w.exports},qGKE:function(e,t,s){"use strict";var i=s("Syo2");s.n(i).a}}]);